<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Store Creation</title>
    <link rel="stylesheet" type="text/css" href="/assets/main.css"/>
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Inter:200,300,400&display=swap" rel="stylesheet"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    
        <meta name="description" content="Learn how to create Stores">
    
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="theme-color" content="#333333">
</head>
<body class="bg-bg font-sans">


<!-- Background color split screen for large screens -->
<div class="fixed top-0 left-0 w-1/2 h-full bg-bg" aria-hidden="true"></div>
<div class="fixed top-0 right-0 w-1/2 h-full bg-bg" aria-hidden="true"></div>
<div class="relative flex flex-col bg-bg">
<!-- Navbar -->
<nav class="fixed h-16 px-4 z-20 w-full font-nunito text-white bg-bg bg-gray-800">
  <div class="relative flex items-center justify-between h-16">
    <a class="flex items-center justify-start px-0 w-48 hover:text-gray-300 min-w-fit" href="/">
      <!-- fritz2 logo -->
      <svg class="ml-1 h-7 w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
           fill="currentColor" stroke="none" >
          <path d="M 9.987 0.229 C 4.469 0.236 0 4.61 0 10.003 C 0 15.401 4.477 19.777 10 19.777 C 15.523 19.777 20 15.401 20 10.003 C 20 4.605 15.523 0.229 10 0.229 C 9.996 0.229 9.992 0.229 9.987 0.229 Z M 14.678 2.662 C 15.144 2.665 15.52 3.043 15.517 3.506 L 15.5 6.862 C 15.497 7.325 15.118 7.699 14.652 7.696 C 14.187 7.694 13.811 7.316 13.813 6.853 L 12.126 6.844 C 11.661 6.842 11.281 7.216 11.278 7.679 L 11.274 8.501 L 12.052 8.501 C 12.072 8.499 12.092 8.499 12.112 8.499 C 12.575 8.499 12.952 8.882 12.952 9.356 C 12.952 9.829 12.575 10.213 12.112 10.213 C 12.089 10.213 12.066 10.212 12.043 10.21 L 7.111 10.21 L 7.111 10.207 C 7.097 10.208 7.084 10.208 7.071 10.208 C 6.607 10.208 6.231 9.825 6.231 9.353 C 6.231 8.881 6.607 8.498 7.071 8.498 C 7.091 8.498 7.111 8.499 7.131 8.501 L 7.9 8.501 L 7.909 6.823 C 7.918 4.969 9.437 3.474 11.3 3.484 L 13.83 3.497 C 13.833 3.034 14.212 2.66 14.678 2.662 Z M 7.887 10.644 L 11.261 10.662 L 11.248 13.179 C 11.238 15.032 9.72 16.527 7.857 16.517 L 6.17 16.509 C 6.167 16.972 5.787 17.346 5.322 17.343 C 4.856 17.341 4.48 16.963 4.483 16.5 L 4.5 13.144 C 4.502 12.681 4.882 12.307 5.348 12.309 C 5.813 12.312 6.189 12.69 6.187 13.153 L 7.031 13.157 C 7.496 13.159 7.876 12.786 7.878 12.322 Z"/>
        </svg>
        <div class="ml-3">
          <span class="text-2xl">fritz2</span>
          <span class="ml-1 text-xs">1.0-SNAPSHOT</span>
        </div>
    </a>






















    <div class="-mr-2 flex items-center md:hidden">
      <!-- Mobile menu button -->
      <button type="button" id="mobile-menu-button" onclick="toggleMenu()"
              class="p-2 inline-flex items-center justify-center bg-gray-800 rounded-md text-gray-400 hover:bg-gray-900 focus:outline-none focus:ring-1 focus-ring-inset focus:ring-gray-400"
              aria-controls="mobile-menu" aria-expanded="false">
        <span class="sr-only">Open menu</span>
        <span class="mobile-icon block h-6 w-6">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" data-heroicon-name="menu" data-heroicon-style="outline"><title>open main menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </span>
        <span class="mobile-icon hidden h-6 w-6">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" data-heroicon-name="x" data-heroicon-style="outline"><title>close main menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
        </span>
      </button>
    </div>
    <!-- Links section -->
    <div class="hidden md:block w-24 md:w-48 lg:w-64 ">
      <div class="flex items-center justify-end hover:text-gray-200">
        <!-- Github -->
        <div class="ml-4 relative flex-shrink-0">
          <div>
            <a target="_blank" href="https://github.com/jwstegemann/fritz2">
              <svg class="mr-1 h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                   fill="currentColor" stroke="none" >
                <path d="M 9.983 0 C 4.458 0 -0.017 4.478 -0.017 10 C -0.017 14.419 2.848 18.167 6.821 19.488 C 7.321 19.582 7.504 19.273 7.504 19.007 C 7.504 18.769 7.496 18.14 7.492 17.307 C 4.71 17.91 4.123 15.965 4.123 15.965 C 3.668 14.811 3.011 14.503 3.011 14.503 C 2.105 13.883 3.081 13.895 3.081 13.895 C 4.085 13.965 4.613 14.925 4.613 14.925 C 5.504 16.454 6.953 16.013 7.525 15.757 C 7.615 15.11 7.873 14.669 8.158 14.419 C 5.938 14.169 3.603 13.309 3.603 9.478 C 3.603 8.386 3.991 7.494 4.633 6.794 C 4.52 6.542 4.183 5.525 4.72 4.148 C 4.72 4.148 5.558 3.879 7.47 5.173 C 8.27 4.95 9.12 4.84 9.97 4.835 C 10.82 4.84 11.67 4.95 12.47 5.173 C 14.37 3.879 15.208 4.148 15.208 4.148 C 15.745 5.525 15.408 6.542 15.308 6.794 C 15.945 7.494 16.333 8.386 16.333 9.478 C 16.333 13.319 13.995 14.165 11.77 14.411 C 12.12 14.711 12.445 15.324 12.445 16.261 C 12.445 17.599 12.433 18.674 12.433 18.999 C 12.433 19.262 12.608 19.574 13.12 19.474 C 17.121 18.163 19.983 14.413 19.983 10 C 19.983 4.478 15.506 0 9.983 0"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

  <!-- Mobile menu, show/hide based on menu state. -->
  <div id="mobile-menu" class="fixed z-10 w-full bg-bg top-16 -translate-y-[100vh] transition-transform duration-250 ease-in md:hidden pb-2 border-b border-b-fg px-2 pt-2 pb-3 h-[calc(100vh-4rem)] overflow-y-auto">
    
    
<nav class="flex-1 bg-bg space-y-2" aria-label="Sidebar">
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="academic-cap" data-heroicon-style="solid"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/></svg>
            </span>
        
        Documentation
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/start/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Getting Started
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/fundamentals/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Fundamentals
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/render/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Render HTML
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/createstores/"
   class=" pl-12 bg-bg-highlight border-fg text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Creation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/storemapping/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Mapping
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/validation/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Validation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/routing/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Routing
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/http/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Http
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/websockets/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Websockets
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/web-components/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Web Components
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="puzzle" data-heroicon-style="solid"><path d="M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"/></svg>
            </span>
        
        Headless Components
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/checkboxgroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        CheckboxGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/datacollection/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        DataCollection
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/disclosure/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Disclosure
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/inputfield/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        InputField
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/listbox/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Listbox (Select)
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/menu/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Menu
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/modal/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Modal
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/popover/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        PopOver
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/radioGroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        RadioGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/switch/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Switch (Toggle)
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/tabgroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        TabGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/textarea/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        TextArea
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/toast/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Toast
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/tooltip/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Tooltip
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/examples/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="color-swatch" data-heroicon-style="solid"><path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z" clip-rule="evenodd"/></svg>
            </span>
        
        Examples
</a>

        
        
            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/blog/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="newspaper" data-heroicon-style="solid"><path fill-rule="evenodd" d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z" clip-rule="evenodd"/><path d="M15 7h1a2 2 0 012 2v5.5a1.5 1.5 0 01-3 0V7z"/></svg>
            </span>
        
        Blog
</a>

        
        
            
        
    
</nav>

    
  </div>

  <!-- 3 column wrapper -->
<div class="mt-16 h-[calc(100vh-4rem)] flex-grow w-full mx-auto md:flex">
  <!-- Left sidebar & main wrapper -->
    <div class="min-w-fit h-full overscroll-none overflow-y-auto w-64 xl:border-b-0 bg-bg hidden md:block">
        <!-- Start left column area -->
        <div class="mt-6 relative" style="min-height: 12rem;">
          
<nav class="flex-1 bg-bg space-y-2" aria-label="Sidebar">
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="academic-cap" data-heroicon-style="solid"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/></svg>
            </span>
        
        Documentation
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/start/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Getting Started
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/fundamentals/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Fundamentals
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/render/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Render HTML
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/createstores/"
   class=" pl-12 bg-bg-highlight border-fg text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Creation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/storemapping/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Mapping
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/validation/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Validation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/routing/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Routing
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/http/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Http
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/websockets/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Websockets
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/web-components/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Web Components
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="puzzle" data-heroicon-style="solid"><path d="M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"/></svg>
            </span>
        
        Headless Components
</a>

        
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/examples/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="color-swatch" data-heroicon-style="solid"><path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z" clip-rule="evenodd"/></svg>
            </span>
        
        Examples
</a>

        
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/blog/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="newspaper" data-heroicon-style="solid"><path fill-rule="evenodd" d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z" clip-rule="evenodd"/><path d="M15 7h1a2 2 0 012 2v5.5a1.5 1.5 0 01-3 0V7z"/></svg>
            </span>
        
        Blog
</a>

        
        
    
</nav>

        </div>
        <!-- End left column area -->
    </div>


    
<div class="bg-bg md:min-w-0 md:flex-1 h-full">
  <div class="h-full py-6 px-5 sm:px-6 lg:px-8 h-full overscroll-none overflow-y-auto bg-bg lg:pr-72">
    <!-- Start main area-->
    <div class="relative content prose prose-invert max-w-prose pb-10">

      <h1>Store Creation</h1>

      

      

      <h2 id="overview" tabindex="-1">Overview</h2>
<p>State handling is probably the key aspect of any reactive web application, so fritz2 supports this with a simple, but
mighty concept: <code>Store</code>s.</p>
<p>A store stores all your data for running an application; no matter if it is domain data or UI state. In contrast to
other approaches, there might be an arbitrary number of stores, which you can connect to handle the overall state
together.</p>
<p>Before we start, let us recap some model types, that are used for some upcoming examples:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// example of some value type</span><br><span class="token keyword">enum</span> <span class="token keyword">class</span> Interest <span class="token punctuation">{</span><br>    Programming<span class="token punctuation">,</span><br>    Sports<span class="token punctuation">,</span><br>    History<span class="token punctuation">,</span><br>    WritingDocumentation<br><span class="token punctuation">}</span><br><br><span class="token comment">// example of an entity</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><br>    <span class="token keyword">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token comment">// stable identifier</span><br>    <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> interests<span class="token operator">:</span> List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><br><span class="token punctuation">)</span></code></pre>
<h3 id="simple-store-by-factory" tabindex="-1">Simple Store by Factory</h3>
<p>The simplest way to create some store is to create one with the <code>storeOf</code> factory:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// a store can be created anywhere in you application!</span><br><span class="token comment">// pass some data as initial state into it</span><br><span class="token keyword">val</span> storedInterest<span class="token operator">:</span> Store<span class="token operator">&lt;</span>Interest<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span>Interest<span class="token punctuation">.</span>Programming<span class="token punctuation">)</span><br><br><span class="token comment">// a store can manage any complex type `T`</span><br><span class="token keyword">val</span> storedPerson<span class="token operator">:</span> Store<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token function">listOf</span><span class="token punctuation">(</span>Interest<span class="token punctuation">.</span>Programming<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Once you have created the store, it can be used for...</p>
<ul>
<li>... rendering the current state into your UI</li>
<li>... dealing with state changes triggered by (user) events.</li>
</ul>
<p>This store supports the former functions by exposing the following two properties out of the box:</p>
<ul>
<li><code>data</code>: This <code>Flow</code> of <code>T</code> can be used to render the current state into the UI by using some <code>render*</code>-functions.
This is described in the <a href="/docs/render/#reactive-rendering">reactive rendering</a> sections of the
<a href="/docs/render">Render HTML</a> chapter.</li>
<li><code>update</code>: This is a <code>Handler</code> which manages a state changes of the store. This particular handler takes one <code>T</code> and
simply substitutes the &quot;old&quot; state <code>T</code> of the store with it.</li>
</ul>
<p>You can use this handler to conveniently implement <em>two-way data binding</em> by using the <code>changes</code> event-flow
of an <code>input</code>-<code>Tag</code>, for example:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> store<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span><br><br>render <span class="token punctuation">{</span><br>    input <span class="token punctuation">{</span><br>        <span class="token comment">// react to data changes and update the UI</span><br>        <span class="token function">value</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>        <br>        <span class="token comment">// react to UI events and update the data state</span><br>        changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy store<span class="token punctuation">.</span>update<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p><code>changes</code> in this example is a <code>Flow</code> of events created by listening to the <code>Change</code>-Event of the underlying input-element.
Calling <code>values()</code> on it extracts the current value from the input.
Whenever such an event is raised, a new value appears on the <code>Flow</code> and is processed by the <code>update</code>-Handler of the
<code>Store</code> to update the model. Event-flows are available for
<a href="https://www.fritz2.dev/api/core/dev.fritz2.core/-with-events/index.html">all HTML5-events</a>.
There are some more <a href="https://www.fritz2.dev/api/core/dev.fritz2.core/-listener/index.html">convenience functions</a> to
help you to extract data from an event or control event-processing.</p>
<h3 id="custom-store" tabindex="-1">Custom Store</h3>
<p>In order to extend a store with own handlers or some specific data-flows, you can create your own store-object:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// use `RootStore` as base class! It implements all the functions you will rely on. </span><br><span class="token keyword">val</span> storedInterests <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// fill with custom functionality</span><br><span class="token punctuation">}</span></code></pre>
<p>Of course, it is also possible to declare a class and create the object later:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">class</span> <span class="token function">InterestsStore</span><span class="token punctuation">(</span>initial<span class="token operator">:</span> List<span class="token operator">&lt;</span>Interest<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// fill with custom functionality</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// use it</span><br><span class="token keyword">val</span> storedInterests <span class="token operator">=</span> <span class="token function">InterestsStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h3 id="custom-handler" tabindex="-1">Custom Handler</h3>
<p>Our custom store already has the handler <code>update</code> which - as we already know - simply substitutes the store's &quot;old&quot; state
with a new one. This is not sufficient, when for example dealing with a list. It would be awkward to <em>add</em> some interest for
example.</p>
<p>For purposes like this, you can create your own handler inside some <code>Store</code> scope with one of the <code>handle</code>-factory
functions.</p>
<p>In this case we need the <code>handle</code> function that takes a <code>action</code> type-parameter,
which is simply our <code>Interest</code> we want to add. Then the lambda function inside the <code>handle</code> factory
has the following two parameters for returning the new state of the store:</p>
<ul>
<li>the <em>old</em> <code>state</code> of the store</li>
<li>the <code>action</code> parameter</li>
</ul>
<p>We can determine the new state simply by adding the new interest to the existing list:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedInterests <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>    <span class="token keyword">val</span> add<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Interest<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> state<span class="token operator">:</span> List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token punctuation">,</span> action<span class="token operator">:</span> Interest <span class="token operator">-></span><br>        <span class="token keyword">if</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> state <span class="token keyword">else</span> state <span class="token operator">+</span> action<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>We can craft a small UI, where the user can click on one item of the list of all existing interests to add one to
his personal interests:</p>
<pre class="language-kotlin"><code class="language-kotlin">div <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"all interests:"</span></span> <span class="token punctuation">}</span><br>ul <span class="token punctuation">{</span><br>    Interest<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span><br>        li <span class="token punctuation">{</span><br>            <span class="token operator">+</span>interest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> interest <span class="token punctuation">}</span> handledBy storedInterests<span class="token punctuation">.</span>add<br>            <span class="token comment">//     ^^^^^^^^^^^^^^^^ ^^^^^^^^^ ^^^^^^^^^^^^^^^^^^</span><br>            <span class="token comment">//     map click to a             connect the Flow with</span><br>            <span class="token comment">//     Flow of Interest           the custom handler</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>div <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"selected interests:"</span></span> <span class="token punctuation">}</span><br>ul <span class="token punctuation">{</span><br>    storedInterests<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span><br>        li <span class="token punctuation">{</span> <span class="token operator">+</span>interest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="custom-data-flow-property" tabindex="-1">Custom Data-Flow Property</h3>
<p>Besides custom handlers a custom store is also a perfect place to hold custom <code>data</code>-flows, which do things like
mapping, filtering, sorting or other operations before the final result should get rendered.</p>
<p>Imagine you want to list the interests grouped by some criteria (which should in real world applications part of the
model of course). You could add a property to your store, that does the filtering and mapping:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedInterests <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <br>    <span class="token keyword">val</span> noneProgramming<span class="token operator">:</span> Flow<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">data</span> <span class="token comment">// use the standard `data`-property as base</span><br>        <span class="token punctuation">.</span><span class="token function">filter</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span> interest<span class="token punctuation">.</span><span class="token function">any</span> <span class="token punctuation">{</span> it <span class="token operator">==</span> Interest<span class="token punctuation">.</span>History <span class="token operator">||</span> it <span class="token operator">==</span> Interest<span class="token punctuation">.</span>Sports <span class="token punctuation">}</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <br>    <span class="token keyword">val</span> add <span class="token operator">=</span> handle <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>And then you can use it for your UI rendering:</p>
<pre class="language-kotlin"><code class="language-kotlin">div <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"selected none programming interests:"</span></span> <span class="token punctuation">}</span><br>ul <span class="token punctuation">{</span><br>    storedInterests<span class="token punctuation">.</span>noneProgramming<span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span><br>        li <span class="token punctuation">{</span> <span class="token operator">+</span>interest <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Of course, you could also do the intermediate operations in place, which might look like this:</p>
<pre class="language-kotlin"><code class="language-kotlin">div <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"selected none programming interests:"</span></span> <span class="token punctuation">}</span><br>ul <span class="token punctuation">{</span><br>    <span class="token comment">// Don't do this in real world!</span><br>    storedInterests<span class="token punctuation">.</span>data<br>        <span class="token punctuation">.</span><span class="token function">filter</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span> interest<span class="token punctuation">.</span><span class="token function">any</span> <span class="token punctuation">{</span> it <span class="token operator">==</span> Interest<span class="token punctuation">.</span>History <span class="token operator">||</span> it <span class="token operator">==</span> Interest<span class="token punctuation">.</span>Sports <span class="token punctuation">}</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> interest <span class="token operator">-></span><br>            li <span class="token punctuation">{</span> <span class="token operator">+</span>interest <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Even though this works, the intermediate operations clutter the UI declaration and make it harder to read. A second
disadvantage is the absence of any meaningful naming; you have to understand all the filtering and mapping to
understand, what would be rendered here. A property in a store always has a (meaningful) name.</p>
<div class="info">
<p>As rule of thumb strive for dedicated properties inside a custom store, to bundle all the needed custom data-flows.</p>
</div>
<h2 id="essentials" tabindex="-1">Essentials</h2>
<h3 id="flows" tabindex="-1">Flows</h3>
<p>As fritz2 heavily depends on flows, introduced by <a href="https://github.com/Kotlin/kotlinx.coroutines">kotlinx.coroutines</a>,
we want to look a little deeper into their concept and why we use them as important building block for the reactive
rendering.</p>
<p>A <code>Flow</code> is a time discrete stream of values.</p>
<p>Like a collection, you can use <code>Flow</code>s to represent multiple values, but unlike other collections like <code>List</code>s, for example,
the values are retrieved one by one. fritz2 relies on <code>Flow</code>s to represent values that change over time and lets you react
to them (your data-model for example) .</p>
<p>A <code>Flow</code> is built from a source which creates the values. This source could be your model or the events raised by an element,
for example. On the other end of the <code>Flow</code>, a simple function called for each element collects the values one by one.
Between those two ends, various actions can be taken on the data (formatting strings, filtering the values, combining values, etc).</p>
<p>The great thing about <code>Flow</code>s is that they are <em>cold</em>, which means that nothing is calculated before the result is needed.
This makes them perfect for fritz2's use case:
It uses flows for the &quot;output&quot; of a store by its <code>data</code>-property and for
<a href="https://www.fritz2.dev/api/core/dev.fritz2.core/-with-events/index.html">all HTML5-events</a>.</p>
<p>They do not consume any memory or CPU load, until they get rendered: The mount-points consumes them and pull new values.</p>
<p>In Kotlin, there is another communication model called <code>Channel</code> which is the <em>hot</em> counterpart of the <code>Flow</code>.
fritz2 only uses <code>Channel</code>s internally to feed the flows, so you should not encounter them while using fritz2.</p>
<p>To get more information about <code>Flow</code>s, <code>Channel</code>s, and their API,
have a look at the <a href="https://kotlinlang.org/docs/flow.html">official documentation</a>.</p>
<h3 id="custom-handler-in-depth" tabindex="-1">Custom Handler in Depth</h3>
<p>As you have already learned from the <a href="#custom-handler">overview</a> it often makes sense to write custom
handlers for a dedicated task.</p>
<p>There are three different variants of handler factories available, which differ in the amount of parameters available
in the handle expression:</p>
<table>
<thead>
<tr>
<th>Factory</th>
<th>Parameters in handle-expression</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Store&lt;T&gt;.handle&lt;Unit&gt;</code></td>
<td><code>state: T</code></td>
<td>New state can only be generated from the old one or some external source. There is no information from the event source available. Typical use cases are resetting to initial state or clearing the store.</td>
</tr>
<tr>
<td><code>Store&lt;T&gt;.handle&lt;A&gt;</code></td>
<td><code>state: T</code>, <code>action: A</code></td>
<td>New state can be based upon information passed from the event source. Typical use cases are updating some part of the overall state or adding or dropping a list item. The default handler <code>update</code> uses this, where its <code>A</code> is a <code>T</code>.</td>
</tr>
<tr>
<td><code>Store&lt;T&gt;.handleAndEmit&lt;A, E&gt;</code></td>
<td><code>state: T</code>, <code>action: A</code></td>
<td>New state can be based upon information passed from the event source. Typical use cases are updating some part of the overall state or adding or dropping a list item. This handler ist a <code>Flow</code> itself one can <code>emit</code> some value <code>E</code> on.</td>
</tr>
</tbody>
</table>
<p>We will look at the first two of them here; the <a href="#emittinghandler---observer-pattern-for-handlers">emitting-handler</a>
is rather an advanced topic and covered in a dedicated section there.</p>
<p>Have a look at our <a href="/examples/masterdetail">nested model</a> example too.</p>
<h4 id="example-use-case" tabindex="-1">Example Use Case</h4>
<p>Let's imagine some application that manages a list of persons.
The application should allow to...</p>
<ul>
<li>... add a new person</li>
<li>... add some interest to a specific person</li>
<li>... clear the whole list</li>
</ul>
<p>First we need a store for a <code>List&lt;Person&gt;</code>, where we can create the needed handlers and some simple UI code, that will
render all persons:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// here we will place our custom handlers</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    section <span class="token punctuation">{</span><br>        h1 <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Persons:"</span></span> <span class="token punctuation">}</span><br>        ul <span class="token punctuation">{</span><br>            storedPersons<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>                dl <span class="token punctuation">{</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Id:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Name:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>name <span class="token punctuation">}</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Interests:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>interests<span class="token punctuation">.</span><span class="token function">joinToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="implement-some-handler-with-action" tabindex="-1">Implement some Handler with Action</h4>
<p>Now we can implement the first requirement: Add a new person.
In order to do so, we will need a new <code>Person</code>-object to be passed into the handler. Inside the handle-code we can then
add this person to the existing list, if the object is not already present in the list to avoid duplicates.</p>
<p>Thus, we need the typical <code>handle</code>-factory, which accepts a so-called <em>action</em> parameter. This could be an arbitrary
type <code>A</code>. The existing default handler <code>update</code> uses the <code>T</code> as action, as it simply substitutes the old state by the
passed new object of the same type. But an action can be any type and is not limited to anything.</p>
<p>In our case the type <code>T</code> of the store is <code>List&lt;Person&gt;</code>, but as action it is sufficient to have a single
<code>Person</code>-object.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>    <span class="token keyword">val</span> addPerson<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons<span class="token punctuation">,</span> newPerson <span class="token operator">-></span><br>        <span class="token comment">//                 ^^^^^^^            ^^^^^^^  ^^^^^^^^^</span><br>        <span class="token comment">//                 defines the        the      the new</span><br>        <span class="token comment">//                 type of parameter  "old"    person</span><br>        <span class="token comment">//                 to pass            state    to add</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>persons<span class="token punctuation">.</span><span class="token function">any</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>id <span class="token operator">==</span> newPerson<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span> persons <span class="token keyword">else</span> persons <span class="token operator">+</span> newPerson<br>        <span class="token comment">//  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^               ^^^^^^^^^^^^^^^^^^^</span><br>        <span class="token comment">//  use the "old" state and the action                  add the action to the</span><br>        <span class="token comment">//  to check for duplicates                             old state to create the new state</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The above handler-code shows some typical pattern: We create the new store's state by analyzing first the &quot;old&quot; state
with some information from the action and then decide whether the old state could remain or there must be some update
also using some information from the action.</p>
<p>Let's &quot;simulate&quot; some UI, that uses this handler:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> addPerson<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons<span class="token punctuation">,</span> newPerson <span class="token operator">-></span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>persons<span class="token punctuation">.</span><span class="token function">any</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>id <span class="token operator">==</span> newPerson<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span> persons <span class="token keyword">else</span> persons <span class="token operator">+</span> newPerson<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br><span class="token comment">// (rendering of person omitted) </span><br><br>    section <span class="token punctuation">{</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Add Fritz"</span></span><br>            clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span><br>                <span class="token comment">// we define some static person; in real life this might be created by some user input</span><br>                <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Fritz"</span></span><span class="token punctuation">,</span> <span class="token function">setOf</span><span class="token punctuation">(</span>Interest<span class="token punctuation">.</span>Programming<span class="token punctuation">,</span> Interest<span class="token punctuation">.</span>History<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span> handledBy storedPersons<span class="token punctuation">.</span>addPerson<br>            <span class="token comment">// in order to call `addPerson`, we need a `Flow&lt;A>` as first parameter for `handledBy`</span><br>            <span class="token comment">// So the flow defines the action `A`, that the handle-code will receive,</span><br>            <span class="token comment">// in this case some `Person`-object</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="use-meta-information-in-action" tabindex="-1">Use Meta-Information in Action</h4>
<p>In order to implement the second requirement, which is to add some interest to some specific person, we should
recap the shape of our model: <code>Person</code> is an <em>entity</em>, so it has some stable identifier. To determine the person in
the list, which some new interest should be added to this person's interests list, we simply can rely on the
<code>Person.id</code>-property.</p>
<p>So our action consists of two parts:</p>
<ul>
<li>the id of the specific person, where the interest will be added to (meta-information)</li>
<li>the interest to add (information)</li>
</ul>
<p>For simple cases like this, a <code>Pair</code> is a sufficient choice to group both information. But of course you could also
create some (data) class or any other kotlin feature that fits.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> addPerson<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><br><br>    <span class="token keyword">val</span> addInterest<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Pair<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons<span class="token punctuation">,</span> <span class="token punctuation">(</span>idForUpdate<span class="token punctuation">,</span> newInterest<span class="token punctuation">)</span> <span class="token operator">-></span><br>        <span class="token comment">//                   ^^^^^^^^^^^^^^^^^^^                       ^^^^^^^^^^^^^^^^^^^^^^^^</span><br>        <span class="token comment">//                   combine meta-information                  destructure meta-information</span><br>        <span class="token comment">//                   with information                          and information</span><br>        <span class="token comment">//                   as action parameter                       for expressive naming</span><br>        persons<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>person<span class="token punctuation">.</span>id <span class="token operator">==</span> idForUpdate<span class="token punctuation">)</span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>interests <span class="token operator">=</span> person<span class="token punctuation">.</span>interests <span class="token operator">+</span> newInterest<span class="token punctuation">)</span> <span class="token keyword">else</span> person<br>            <span class="token comment">//               ^^^^^^^^^^^                                             ^^^^^^^^^^^</span><br>            <span class="token comment">//               use meta-information to determine the specific          use the information portion</span><br>            <span class="token comment">//               person that must get an update                          from action to update the person</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    <span class="token comment">// (rendering of person omitted)</span><br><br>    section <span class="token punctuation">{</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Make Fritz write Documentation"</span></span><br>            clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span><br>                <span class="token comment">// create the Pair of meta-information and information</span><br>                <span class="token number">1</span> <span class="token keyword">to</span> Interest<span class="token punctuation">.</span>WritingDocumentation<br>            <span class="token punctuation">}</span> handledBy storedPersons<span class="token punctuation">.</span>addInterest<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="create-handler-without-external-information" tabindex="-1">Create Handler without external Information</h4>
<p>The last task is quite easy: It should be possible, to clear the complete list of users.</p>
<p>We can set an empty list as new store's state without any further information. Thus, the handler we must create does not
need any action parameter at all.</p>
<p>fritz2 offers a special variant for cases like this, where the action type is <code>Unit</code>.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> addPerson<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><br>    <span class="token keyword">val</span> addInterest<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Pair<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><br><br>    <span class="token keyword">val</span> clear<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Unit<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    <span class="token comment">// (rendering of person omitted) </span><br><br>    section <span class="token punctuation">{</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Clear Persons"</span></span><br>            clicks handledBy storedPersons<span class="token punctuation">.</span>clear<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Don't be fooled: Inside the handler-code the &quot;old&quot; state would be available; we simply do not need it for our
implementation. Just to make this more explicit, look at this:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> clear<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Unit<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons <span class="token operator">-></span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Dropped list of </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">persons<span class="token punctuation">.</span>size</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> persons..."</span></span><span class="token punctuation">)</span>    <br>    <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <br><span class="token punctuation">}</span></code></pre>
<p>There are other use-cases where the access to the old state is definitely needed, and you always have access therefore.</p>
<h4 id="complete-example" tabindex="-1">Complete Example</h4>
<p>Just to show you the final result en block:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>    <span class="token keyword">val</span> addPerson<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons<span class="token punctuation">,</span> newPerson <span class="token operator">-></span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>persons<span class="token punctuation">.</span><span class="token function">any</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>id <span class="token operator">==</span> newPerson<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span> persons <span class="token keyword">else</span> persons <span class="token operator">+</span> newPerson<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">val</span> addInterest<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Pair<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> persons<span class="token punctuation">,</span> <span class="token punctuation">(</span>idForUpdate<span class="token punctuation">,</span> newInterest<span class="token punctuation">)</span> <span class="token operator">-></span><br>        persons<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>person<span class="token punctuation">.</span>id <span class="token operator">==</span> idForUpdate<span class="token punctuation">)</span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>interests <span class="token operator">=</span> person<span class="token punctuation">.</span>interests <span class="token operator">+</span> newInterest<span class="token punctuation">)</span> <span class="token keyword">else</span> person<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">val</span> clear<span class="token operator">:</span> Handler<span class="token operator">&lt;</span>Unit<span class="token operator">></span> <span class="token operator">=</span> handle <span class="token punctuation">{</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    section <span class="token punctuation">{</span><br>        h1 <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Persons:"</span></span> <span class="token punctuation">}</span><br>        ul <span class="token punctuation">{</span><br>            storedPersons<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>                dl <span class="token punctuation">{</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Id:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Name:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>name <span class="token punctuation">}</span><br>                    dt <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Interests:"</span></span> <span class="token punctuation">}</span><br>                    dd <span class="token punctuation">{</span> <span class="token operator">+</span>person<span class="token punctuation">.</span>interests<span class="token punctuation">.</span><span class="token function">joinToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    section <span class="token punctuation">{</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Add Fritz"</span></span><br>            clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span><br>                <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"Fritz"</span></span><span class="token punctuation">,</span> <span class="token function">setOf</span><span class="token punctuation">(</span>Interest<span class="token punctuation">.</span>Programming<span class="token punctuation">,</span> Interest<span class="token punctuation">.</span>History<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span> handledBy storedPersons<span class="token punctuation">.</span>addPerson<br>        <span class="token punctuation">}</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Make Fritz write Documentation"</span></span><br>            clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span><br>                <span class="token number">1</span> <span class="token keyword">to</span> Interest<span class="token punctuation">.</span>WritingDocumentation<br>            <span class="token punctuation">}</span> handledBy storedPersons<span class="token punctuation">.</span>addInterest<br>        <span class="token punctuation">}</span><br>        button <span class="token punctuation">{</span><br>            <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Clear Persons"</span></span><br>            clicks handledBy storedPersons<span class="token punctuation">.</span>clear<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="calling-a-handler-directly" tabindex="-1">Calling a Handler directly</h3>
<p>If you need to purposefully fire an action somewhere inside a <code>RenderContext</code> or a <code>Store</code> you can directly invoke
a <code>Handler</code>:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">//call handler with data</span><br>someStore<span class="token punctuation">.</span><span class="token function">someHandler</span><span class="token punctuation">(</span>someAction<span class="token punctuation">)</span><br><br><span class="token comment">//call handler without data</span><br>someStore<span class="token punctuation">.</span><span class="token function">someHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h3 id="ad-hoc-handler---handler-without-a-store" tabindex="-1">Ad Hoc Handler - Handler without a Store</h3>
<p>It is possible in fritz2 to create some handler without any store.</p>
<p>Common use cases are the combination of multiple handler calls based upon the same event or to simply create a working
placeholder before the store is ready.</p>
<p>The syntax is simple: Just pass an expression of type <code>(A) -&gt; Unit</code> to the <code>handledBy</code>-function, where <code>A</code> is the
inner type of the flow.</p>
<p>Look at this example:</p>
<pre class="language-kotlin"><code class="language-kotlin">section <span class="token punctuation">{</span><br>    button <span class="token punctuation">{</span><br>        <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Remove Fritz"</span></span><br>        clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> <span class="token number">1</span> <span class="token punctuation">}</span> handledBy <span class="token punctuation">{</span> id <span class="token operator">-></span><br>            <span class="token comment">// `removePerson` handler is not ready yet; but UI should be checked to work</span><br>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Would delete person with id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">id</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="extend-none-custom-(local)-stores" tabindex="-1">Extend None Custom (Local) Stores</h3>
<p>Sometimes creating a <a href="#custom-stores">custom store</a> is kinda overkill or there are certain situations, where it is
simply more feasible to rely on <a href="/docs/storemapping/">store-mapping</a> which implies there is no custom store available.</p>
<p>In those cases - often in some small local code area - it is totally ok, to customize a standard store created by
<code>storeOf</code>-factory.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPerson <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> <span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">// define handler on some store object</span><br><span class="token keyword">val</span> addInterest <span class="token operator">=</span> storedPerson<span class="token punctuation">.</span>handle<span class="token operator">&lt;</span>Interest<span class="token operator">></span> <span class="token punctuation">{</span> person<span class="token punctuation">,</span> interest <span class="token operator">-></span><br>    person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>interests <span class="token operator">=</span> person<span class="token punctuation">.</span>interests <span class="token operator">+</span> interest<span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    button <span class="token punctuation">{</span><br>        <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Make fritz write documentation"</span></span><br>        clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> Interest<span class="token punctuation">.</span>WritingDocumentation <span class="token punctuation">}</span> handledBy addInterest<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>As the <code>handler</code>-factory functions are <em>extension</em> functions, it is possible to extend a &quot;closed&quot; store-object.</p>
<h3 id="connecting-stores-to-each-other" tabindex="-1">Connecting Stores to Each Other</h3>
<p>Most real-world applications contain multiple stores which need to be linked to properly react to model changes.</p>
<p>To make your stores interconnect, fritz2 allows calling <code>Handlers</code> of others stores directly with or
without a parameter.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">object</span> SaveStore <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> save <span class="token operator">=</span> handle<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> <span class="token keyword">data</span> <span class="token operator">-></span> <span class="token keyword">data</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">object</span> InputStore <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <br>    <span class="token keyword">val</span> input <span class="token operator">=</span> handle<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> input <span class="token operator">-></span><br>        SaveStore<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token comment">// call other store`s handler</span><br>        input <span class="token comment">// do not forget to return the "next" store state!</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Have a look at our <a href="/examples/nestedmodel">nested model</a> example too.</p>
<h3 id="history-in-stores" tabindex="-1">History in Stores</h3>
<p>Sometimes you may want to keep the history of states in your store, so you can navigate back in time to build an
undo-function or maybe just for debugging...</p>
<p>fritz2 offers a <code>history</code> factory to do so.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> store <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> history <span class="token operator">=</span> <span class="token function">history</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<p>By default, you synchronise the history with the updates of your store,
so each new state will be added to the history automatically.</p>
<p>Calling <code>history(synced = false)</code>, you can control the content of the history
by manually adding new entries. Call <code>push(entry)</code> to do so.</p>
<p>You can access the complete history via its <code>data</code> attribute as <code>Flow&lt;List&lt;T&gt;&gt;</code>
or by using <code>current</code> attribute which returns a <code>List&lt;T&gt;</code>. For your convenience <code>history</code> also offers</p>
<ul>
<li>a <code>Flow&lt;Boolean&gt;</code> called <code>available</code> representing if entries are available (e.g., to show or hide an undo button)</li>
<li>a <code>back()</code> method to get the latest entry and remove it from the history</li>
<li>a <code>clear()</code> method to clear the history</li>
</ul>
<p>For a store with a minimal undo function you just have to write:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedData <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> hist <span class="token operator">=</span> <span class="token function">history</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token comment">// your handlers go here (add history.clear() here where suitable)</span><br><br>    <span class="token keyword">val</span> undo <span class="token operator">=</span> handle <span class="token punctuation">{</span> hist<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    <span class="token function">div</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"form"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        input <span class="token punctuation">{</span><br>            <span class="token function">value</span><span class="token punctuation">(</span>storedData<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>            changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedData<span class="token punctuation">.</span>update<br>        <span class="token punctuation">}</span><br>        storedData<span class="token punctuation">.</span>hist<span class="token punctuation">.</span>available<span class="token punctuation">.</span><span class="token function">render</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">button</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"btn"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                    <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Undo"</span></span><br>                <span class="token punctuation">}</span><span class="token punctuation">.</span>clicks handledBy storedData<span class="token punctuation">.</span>undo<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="track-processing-state-of-stores" tabindex="-1">Track Processing State of Stores</h3>
<p>When one of your handlers contains a long-running action (like server-call, etc.) you might want to keep the user
informed that something is going on.</p>
<p>Using fritz2 you can use the <code>tracker</code> factory to implement this:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedData <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> tracking <span class="token operator">=</span> <span class="token function">tracker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token keyword">val</span> save <span class="token operator">=</span> handle <span class="token punctuation">{</span> model <span class="token operator">-></span><br>        tracking<span class="token punctuation">.</span><span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span> <span class="token comment">// do something that takes a while</span><br>            <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">model</span></span><span class="token string">."</span></span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    <span class="token function">button</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"btn"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">className</span><span class="token punctuation">(</span>storedData<span class="token punctuation">.</span>tracking<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token string-literal singleline"><span class="token string">"spinner"</span></span> <span class="token keyword">else</span> <span class="token string-literal singleline"><span class="token string">""</span></span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>        <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"save"</span></span><br>        clicks handledBy storedData<span class="token punctuation">.</span>save<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The service provides you with a boolean <code>Flow</code> representing the state of the running transaction.</p>
<p>Beware that you are responsible for handling exceptions, if you use an unsafe operation within the tracking scope.
The tracker is safe in the way, that it will catch any escaped exception, then stops the tracking, and finally it will
rethrow the former.</p>
<p>If you want your tracking to continue instead, just handle exceptions within the tracking scope.</p>
<h2 id="advanced-topics" tabindex="-1">Advanced Topics</h2>
<h3 id="emittinghandler---observer-pattern-for-handlers" tabindex="-1">EmittingHandler - Observer Pattern for Handlers</h3>
<p>In cases where you don't know which <code>Handler</code> of another store will handle the data exposed by your handler, you can use
the <code>EmittingHandler</code>, a type of handler that doesn't just take data
as an argument but also emits data on a new <code>Flow</code> for other handlers to receive.</p>
<p>Create such a handler by calling the <code>handleAndEmit&lt;T&gt;()</code> function instead of the usual <code>handle()</code> function and add the
offered data type to the type brackets:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> personStore <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> save <span class="token operator">=</span> handleAndEmit<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>        <span class="token function">emit</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token comment">// emits current person</span><br>        <span class="token function">Person</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">// return a new empty person (set as new store state)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The <code>EmittingHandler</code> named <code>save</code> emits the saved <code>Person</code> on its <code>Flow</code>.
Another store can be setup to handle this <code>Person</code> by connecting the handlers:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> personStore <span class="token operator">=</span> <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token comment">//see above</span><br><br><span class="token keyword">val</span> personListStore <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span><span class="token punctuation">(</span>emptyList<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> add <span class="token operator">=</span> handle<span class="token operator">&lt;</span>Person<span class="token operator">></span> <span class="token punctuation">{</span> list<span class="token punctuation">,</span> person <span class="token operator">-></span><br>       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"add new person: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">person</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>       list <span class="token operator">+</span> person<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">init</span> <span class="token punctuation">{</span><br>       <span class="token comment">// don't forget to connect the handlers</span><br>       personStore<span class="token punctuation">.</span>save handledBy personListStore<span class="token punctuation">.</span>add<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>After connecting these two stores via their handlers, a saved <code>Person</code> will also be added to the list
in <code>personListStore</code>. All dependent components will be updated accordingly.</p>
<p>To see a complete example visit our
<a href="/examples/validation">validation example</a> which uses connected
stores and validate a <code>Person</code> before adding it to a list of <code>Person</code>s.</p>
<h3 id="react-to-changes-inside-the-store-itself" tabindex="-1">React to Changes inside the Store itself</h3>
<p>If you need a handler's code to be executed whenever the model is changed,
you have to use the <code>drop(1)</code> function on a <code>Flow</code> to skip the <code>initialData</code>:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> store <span class="token operator">=</span> <span class="token keyword">object</span> <span class="token operator">:</span> RootStore<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"initial"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">init</span> <span class="token punctuation">{</span><br>        <span class="token keyword">data</span><span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> handledBy <span class="token punctuation">{</span><br>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"model changed to: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>By using the ad-hoc <code>handledBy</code> function here your store gets not updated after new data arrives.</p>


    </div>
    <a class="group flex items-center px-1 py-1 pb-6 text-sm text-cyan-300 hover:underline" href="https://github.com/jwstegemann/fritz2/blob/master/www/src/pages/docs/40_StoreCreation.md" target="_blank">
      <span class="mr-1 flex-shrink-0 h-4 w-4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" />
        </svg>
      </span>
      Edit this page on Github
    </a>
    <!-- End main area -->
  </div>
</div>

<div
    class="fixed lg:block top-0 right-0 pt-16 h-full hidden pr-4 sm:pr-6 lg:pr-8 lg:pr-2">
    <div class="w-64 h-full overscroll-none overflow-y-auto pl-6 py-6">
        <!-- Start right column area -->
        <div class="h-full relative" style="min-height: 16rem;">

            <h2 class="text-sm font-bold capitalize text-fg-highlight mb-4">On this Page</h2>

            <nav class="toc" >
        <ul><li><a href="#overview">Overview</a><ul><li><a href="#simple-store-by-factory">Simple Store by Factory</a></li><li><a href="#custom-store">Custom Store</a></li><li><a href="#custom-handler">Custom Handler</a></li><li><a href="#custom-data-flow-property">Custom Data-Flow Property</a></li></ul></li><li><a href="#essentials">Essentials</a><ul><li><a href="#flows">Flows</a></li><li><a href="#custom-handler-in-depth">Custom Handler in Depth</a><ul><li><a href="#example-use-case">Example Use Case</a></li><li><a href="#implement-some-handler-with-action">Implement some Handler with Action</a></li><li><a href="#use-meta-information-in-action">Use Meta-Information in Action</a></li><li><a href="#create-handler-without-external-information">Create Handler without external Information</a></li><li><a href="#complete-example">Complete Example</a></li></ul></li><li><a href="#calling-a-handler-directly">Calling a Handler directly</a></li><li><a href="#ad-hoc-handler---handler-without-a-store">Ad Hoc Handler - Handler without a Store</a></li><li><a href="#extend-none-custom-(local)-stores">Extend None Custom (Local) Stores</a></li><li><a href="#connecting-stores-to-each-other">Connecting Stores to Each Other</a></li><li><a href="#history-in-stores">History in Stores</a></li><li><a href="#track-processing-state-of-stores">Track Processing State of Stores</a></li></ul></li><li><a href="#advanced-topics">Advanced Topics</a><ul><li><a href="#emittinghandler---observer-pattern-for-handlers">EmittingHandler - Observer Pattern for Handlers</a></li><li><a href="#react-to-changes-inside-the-store-itself">React to Changes inside the Store itself</a></li></ul></li></ul>
      </nav>

        </div>
        <!-- End right column area -->
    </div>
</div>


  </div>
</div>


<script src="/assets/main.js"></script>
</body>
</html>
